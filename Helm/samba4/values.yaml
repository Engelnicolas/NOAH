replicaCount: 1

image:
  repository: theworkflow/samba4
  pullPolicy: IfNotPresent
  tag: "latest"

service:
  type: ClusterIP
  ports:
    ldap: 389
    ldaps: 636
    kerberos: 88
    kpasswd: 464
    smb: 445
    netbios: 139
  # Enable headless service for better DNS resolution
  clusterIP: None
  # Add annotations for Cilium service mesh
  annotations:
    service.cilium.io/global: "true"
    service.cilium.io/shared: "true"

persistence:
  enabled: true
  existingClaim: samba4-data
  size: 10Gi
  storageClass: ""
  accessMode: ReadWriteOnce

domain:
  name: NOAH.LOCAL
  realm: NOAH.LOCAL
  adminPassword: "" # Will be auto-generated if empty, or set from external secret management
  dnsForwarder: "8.8.8.8"
  netbiosName: DC1

# Authentication configuration
auth:
  # Admin password - leave empty for auto-generation
  adminPassword: ""
  # Set to true to use external secret management (SOPS/Age)
  externalSecrets: true
  # Secret name for external management
  secretName: "samba4-security-secrets"

resources:
  limits:
    cpu: 1000m
    memory: 1024Mi
  requests:
    cpu: 250m
    memory: 256Mi

# Network policy configuration
networkPolicy:
  enabled: true
  allowFromNamespace: "identity"

# Service mesh configuration
serviceMesh:
  enabled: true
  annotations:
    service.cilium.io/global: "true"
    service.cilium.io/shared: "true"
  requests:
    cpu: 500m
    memory: 512Mi

# Health check configuration
healthcheck:
  livenessProbe:
    initialDelaySeconds: 60
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 3

nodeSelector: {}
tolerations: []
affinity: {}

securityContext:
  capabilities:
    add:
      - SYS_ADMIN
      - NET_ADMIN
